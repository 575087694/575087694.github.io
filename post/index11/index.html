<!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <base href="http://575087694.github.io/">
  <title>10、jQuery - JavaScript入门</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="My short description">
  <meta name="author" content="SmallLiu">
  <meta itemprop="name" content="10、jQuery - JavaScript入门">
  <meta itemprop="description" content="My short description">
  <meta itemprop="image" content="http://575087694.github.io/img/author.jpg">
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@SmallLiu" />
  <meta name="twitter:title" content="10、jQuery - JavaScript入门" />
  <meta name="twitter:description" content="My short description" />
  
  <link rel="shortcut icon" href="img/favicon.ico"/>
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="apple-touch-icon.png" />
  <link rel="stylesheet" href="highlight/styles/github.css">
  <script src="highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <link rel="stylesheet" href="font/hack/css/hack.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <header>
    <div>
  
  <div id="imglogo">
    <a href="http://575087694.github.io/"><img src="http://575087694.github.io/img/logo.svg" alt="JavaScript入门" title="JavaScript入门"/></a>
  </div>
  
  <div id="textlogo">
    <h1 class="site-name"><a href="http://575087694.github.io/" title="JavaScript入门">JavaScript入门</a></h1>
    <h2 class="blog-motto">subtitle</h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
  <nav class="animated">
    <ul>
      
      <li><a href="/">首页</a></li>
      
      <li><a href="/about/">关于</a></li>
      
      <li>
        <form class="search" method="get" action="https://www.google.com/search">
          <div>
            <input type="text" id="search" name="q" placeholder="搜索">
          </div>
        </form>
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody">
    <header class="article-info clearfix">
  <h1 itemprop="name">
      <a href="http://575087694.github.io/post/index11/" title="10、jQuery" itemprop="url">10、jQuery</a>
  </h1>
  <p class="article-author">By
    
      <a href="http://575087694.github.io/" title="SmallLiu">SmallLiu</a>
    
  </p>
  <p class="article-time">
    <time datetime="2014-01-22 05:04:40 &#43;0000 UTC" itemprop="datePublished">2014年01月22日</time>
  </p>
</header>

	<div class="article-content">
    
    

<p>jQuery是目前使用最广泛的JavaScript函数库。据<a href="http://w3techs.com/technologies/details/js-jquery/all/all">统计</a>，全世界57.5%的网站使用jQuery，在使用JavaScript函数库的网站中，93.0%使用jQuery。它已经成了开发者必须学会的技能。</p>

<p>jQuery的最大优势有两个。首先，它基本是一个DOM操作工具，可以使操作DOM对象变得异常容易。其次，它统一了不同浏览器的API接口，使得代码在所有现代浏览器均能运行，开发者不用担心浏览器之间的差异。</p>

<h2 id="jquery的加载:99a497817131bf421a863230ef787bd1">jQuery的加载</h2>

<p>一般采用下面的写法，在网页中加载jQuery。</p>

<pre><code class="language-html">&lt;script type=&quot;text/javascript&quot;
  src=&quot;//code.jquery.com/jquery-1.11.0.min.js&quot;&gt;
&lt;/script&gt;
&lt;script&gt;
window.jQuery ||
  document.write(
    '&lt;script src=&quot;js/jquery-1.11.0.min.js&quot; type=&quot;text/javascript&quot;&gt;&lt;\/script&gt;'
  );
&lt;/script&gt;
</code></pre>

<p>上面代码有两点需要注意。一是采用<a href="http://jquery.com/download/#using-jquery-with-a-cdn">CDN</a>加载。如果CDN加载失败，则退回到本地加载。二是采用协议无关的加载网址（使用双斜线表示），同时支持http协议和https协议。</p>

<p>目前常用的jQuery CDN有以下这些。</p>

<ul>
<li><a href="https://developers.google.com/speed/libraries/devguide#jquery">Google CDN</a></li>
<li><a href="http://www.asp.net/ajax/cdn#jQuery_Releases_on_the_CDN_0">Microsoft CDN</a></li>
<li><a href="http://jquery.com/download/#jquery-39-s-cdn-provided-by-maxcdn">jQuery CDN</a></li>
<li><a href="http://cdnjs.com/libraries/jquery/">CDNJS CDN</a></li>
<li><a href="http://www.jsdelivr.com/#!jquery">jsDelivr CDN</a></li>
</ul>

<p>上面这段代码最好放到网页尾部。如果需要支持IE 6/7/8，就使用jQuery 1.x版，否则使用最新版。</p>

<h2 id="jquery基础:99a497817131bf421a863230ef787bd1">jQuery基础</h2>

<h3 id="jquery对象:99a497817131bf421a863230ef787bd1">jQuery对象</h3>

<p>jQuery最重要的概念，就是<code>jQuery</code>对象。它是一个全局对象，可以简写为美元符号<code>$</code>。也就是说，<code>jQuery</code>和<code>$</code>两者是等价的。</p>

<p>在网页中加载jQuery函数库以后，就可以使用jQuery对象了。jQuery的全部方法，都定义在这个对象上面。</p>

<pre><code class="language-javascript">var listItems = jQuery('li');
// or
var listItems = $('li');
</code></pre>

<p>上面两行代码是等价的，表示选中网页中所有的<code>li</code>元素。</p>

<h3 id="jquery构造函数:99a497817131bf421a863230ef787bd1">jQuery构造函数</h3>

<p><code>jQuery</code>对象本质上是一个构造函数，主要作用是返回<code>jQuery</code>对象的实例。比如，上面代码表面上是选中<code>li</code>元素，实际上是返回对应于<code>li</code>元素的<code>jQuery</code>实例。因为只有这样，才能在DOM对象上使用jQuery提供的各种方法。</p>

<pre><code class="language-javascript">$('body').nodeType
// undefined

$('body') instanceof jQuery
// true
</code></pre>

<p>上面代码表示，由于jQuery返回的不是DOM对象，所以没有DOM属性<code>nodeType</code>。它返回的是jQuery对象的实例。</p>

<p>jQuery构造函数可以多种参数，返回不同的值。</p>

<p><strong>（1）CSS选择器作为参数</strong></p>

<p>jQuery构造函数的参数，主要是CSS选择器，就像上面的那个例子。下面是另外一些CSS选择器的例子。</p>

<pre><code class="language-javascript">$(&quot;*&quot;)
$(&quot;#lastname&quot;)
$(&quot;.intro&quot;)
$(&quot;h1,div,p&quot;)
$(&quot;p:last&quot;)
$(&quot;tr:even&quot;)
$(&quot;p:first-child&quot;)
$(&quot;p:nth-of-type(2)&quot;)
$(&quot;div + p&quot;)
$(&quot;div:has(p)&quot;)
$(&quot;:empty&quot;)
$(&quot;[title^='Tom']&quot;)
</code></pre>

<p>本书不讲解CSS选择器，请读者参考有关书籍和jQuery文档。</p>

<p>除了CSS选择器，jQuery还定义了一些自有的选择器，比如<code>contains</code>选择器用来选择包含特定文本的元素。下面是一个例子。</p>

<pre><code class="language-javascript">var search = $('#search').val();
$('div:not(:contains(&quot;' + search + '&quot;))').hide();
</code></pre>

<p>上面代码用来选中包含搜索框输入文本的元素。</p>

<p><strong>（2）DOM对象作为参数</strong></p>

<p>jQuery构造函数的参数，还可以是DOM对象。它也会被转为jQuery对象的实例。</p>

<pre><code class="language-javascript">$(document.body) instanceof jQuery
// true
</code></pre>

<p>上面代码中，jQuery的参数不是CSS选择器，而是一个DOM对象，返回的依然是jQuery对象的实例。</p>

<p>如果有多个DOM元素要转为jQuery对象的实例，可以把DOM元素放在一个数组里，输入jQuery构造函数。</p>

<pre><code class="language-javascript">$([document.body, document.head])
</code></pre>

<p><strong>（3）HTML字符串作为参数</strong></p>

<p>如果直接在jQuery构造函数中输入HTML字符串，返回的也是jQuery实例。</p>

<pre><code class="language-javascript">$('&lt;li class=&quot;greet&quot;&gt;test&lt;/li&gt;')
</code></pre>

<p>上面代码从HTML代码生成了一个jQuery实例，它与从CSS选择器生成的jQuery实例完全一样。唯一的区别就是，它对应的DOM结构不属于当前文档。</p>

<p>上面代码也可以写成下面这样。</p>

<pre><code class="language-javascript">$( '&lt;li&gt;', {
  html: 'test',
  'class': 'greet'
});
</code></pre>

<p>上面代码中，由于<code>class</code>是javaScript的保留字，所以只能放在引号中。</p>

<p>通常来说，上面第二种写法是更好的写法。</p>

<pre><code class="language-javascript">$('&lt;input class=&quot;form-control&quot; type=&quot;hidden&quot; name=&quot;foo&quot; value=&quot;bar&quot; /&gt;')

// 相当于
$('&lt;input/&gt;', {
  'class': 'form-control',
  type: 'hidden',
  name: 'foo',
  value: 'bar'
})

// 或者
$('&lt;input/&gt;')
.addClass('form-control')
.attr('type', 'hidden')
.attr('name', 'foo')
.val('bar')
</code></pre>

<p>由于新增的DOM节点不属于当前文档，所以可以用这种写法预加载图片。</p>

<pre><code class="language-javascript">$.preloadImages = function () {
  for (var i = 0; i &lt; arguments.length; i++) {
    $('&lt;img&gt;').attr('src', arguments[i]);
  }
};

$.preloadImages('img/hover-on.png', 'img/hover-off.png');
</code></pre>

<p><strong>（4）第二个参数</strong></p>

<p>默认情况下，jQuery将文档的根元素（<code>html</code>）作为寻找匹配对象的起点。如果要指定某个网页元素（比如某个<code>div</code>元素）作为寻找的起点，可以将它放在jQuery函数的第二个参数。</p>

<pre><code class="language-javascript">$('li', someElement);
</code></pre>

<p>上面代码表示，只寻找属于someElement对象下属的li元素。someElement可以是jQuery对象的实例，也可以是DOM对象。</p>

<h3 id="jquery构造函数返回的结果集:99a497817131bf421a863230ef787bd1">jQuery构造函数返回的结果集</h3>

<p>jQuery的核心思想是“先选中某些网页元素，然后对其进行某种处理”（find something, do something），也就是说，先选择后处理，这是jQuery的基本操作模式。所以，绝大多数jQuery操作都是从选择器开始的，返回一个选中的结果集。</p>

<p><strong>（1）length属性</strong></p>

<p>jQuery对象返回的结果集是一个类似数组的对象，包含了所有被选中的网页元素。查看该对象的length属性，可以知道到底选中了多少个结果。</p>

<p>{% highlight javascript %}</p>

<p>if ( $(&lsquo;li&rsquo;).length === 0 ) {
    console.log(&lsquo;不含li元素&rsquo;);
}</p>

<p>{% endhighlight %}</p>

<p>上面代码表示，如果网页没有li元素，则返回对象的length属性等于0。这就是测试有没有选中的标准方法。</p>

<p>所以，如果想知道jQuery有没有选中相应的元素，不能写成下面这样。</p>

<p>{% highlight javascript %}</p>

<p>if ($(&lsquo;div.foo&rsquo;)) { &hellip; }</p>

<p>{% endhighlight %}</p>

<p>因为不管有没有选中，jQuery构造函数总是返回一个实例对象，而对象的布尔值永远是true。使用length属性才是判断有没有选中的正确方法。</p>

<p>{% highlight javascript %}</p>

<p>if ($(&lsquo;div.foo&rsquo;).length) { &hellip; }</p>

<p>{% endhighlight %}</p>

<p><strong>（2）下标运算符</strong></p>

<p>jQuery选择器返回的是一个类似数组的对象。但是，使用下标运算符取出的单个对象，并不是jQuery对象的实例，而是一个DOM对象。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;)[0] instanceof jQuery // false
$(&lsquo;li&rsquo;)[0] instanceof Element // true</p>

<p>{% endhighlight %}</p>

<p>上面代码表示，下标运算符取出的是Element节点的实例。所以，通常使用下标运算符将jQuery实例转回DOM对象。</p>

<p><strong>（3）is方法</strong></p>

<p>is方法返回一个布尔值，表示选中的结果是否符合某个条件。这个用来验证的条件，可以是CSS选择器，也可以是一个函数，或者DOM元素和jQuery实例。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).is(&lsquo;li&rsquo;) // true</p>

<p>$(&lsquo;li&rsquo;).is($(&lsquo;.item&rsquo;))</p>

<p>$(&lsquo;li&rsquo;).is(document.querySelector(&lsquo;li&rsquo;))</p>

<p>$(&lsquo;li&rsquo;).is(function() {
      return $(&ldquo;strong&rdquo;, this).length === 0;
});</p>

<p>{% endhighlight %}</p>

<p><strong>（4）get方法</strong></p>

<p>jQuery实例的get方法是下标运算符的另一种写法。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).get(0) instanceof Element // true</p>

<p>{% endhighlight %}</p>

<p><strong>（5）eq方法</strong></p>

<p>如果想要在结果集取出一个jQuery对象的实例，不需要取出DOM对象，则使用eq方法，它的参数是实例在结果集中的位置（从0开始）。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).eq(0) instanceof jQuery // true</p>

<p>{% endhighlight %}</p>

<p>由于eq方法返回的是jQuery的实例，所以可以在返回结果上使用jQuery实例对象的方法。</p>

<p><strong>（6）each方法，map方法</strong></p>

<p>这两个方法用于遍历结果集，对每一个成员进行某种操作。</p>

<p>each方法接受一个函数作为参数，依次处理集合中的每一个元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).each(function( index, element) {
  $(element).prepend( &lsquo;<em>&rsquo; + index + &lsquo;: </em>&rsquo; );
});</p>

<p>// <li>Hello</li>
// <li>World</li>
// 变为
// <li><em>0: </em>Hello</li>
// <li><em>1: </em>World</li></p>

<p>{% endhighlight %}</p>

<p>从上面代码可以看出，作为each方法参数的函数，本身有两个参数，第一个是当前元素在集合中的位置，第二个是当前元素对应的DOM对象。</p>

<p>map方法的用法与each方法完全一样，区别在于each方法没有返回值，只是对每一个元素执行某种操作，而map方法返回一个新的jQuery对象。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;input&rdquo;).map(function (index, element){
    return $(this).val();
})
.get()
.join(&ldquo;, &ldquo;)</p>

<p>{% endhighlight %}</p>

<p>上面代码表示，将所有input元素依次取出值，然后通过get方法得到一个包含这些值的数组，最后通过数组的join方法返回一个逗号分割的字符串。</p>

<p><strong>（8）内置循环</strong></p>

<p>jQuery默认对当前结果集进行循环处理，所以如果直接使用jQuery内置的某种方法，each和map方法是不必要的。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;.class&rdquo;).addClass(&ldquo;highlight&rdquo;);</p>

<p>{% endhighlight %}</p>

<p>上面代码会执行一个内部循环，对每一个选中的元素进行addClass操作。由于这个原因，对上面操作加上each方法是不必要的。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;.class&rdquo;).each(function(index,element){
     $(element).addClass(&ldquo;highlight&rdquo;);
});</p>

<p>// 或者</p>

<p>$(&ldquo;.class&rdquo;).each(function(){
    $(this).addClass(&ldquo;highlight&rdquo;);
});</p>

<p>{% endhighlight %}</p>

<p>上面代码的each方法，都是没必要使用的。</p>

<p>由于内置循环的存在，从性能考虑，应该尽量减少不必要的操作步骤。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;.class&rdquo;).css(&ldquo;color&rdquo;, &ldquo;green&rdquo;).css(&ldquo;font-size&rdquo;, &ldquo;16px&rdquo;);</p>

<p>// 应该写成</p>

<p>$(&ldquo;.class&rdquo;).css({
  &ldquo;color&rdquo;: &ldquo;green&rdquo;,
  &ldquo;font-size&rdquo;: &ldquo;16px&rdquo;
});</p>

<p>{% endhighlight %}</p>

<h3 id="链式操作:99a497817131bf421a863230ef787bd1">链式操作</h3>

<p>jQuery最方便的一点就是，它的大部分方法返回的都是jQuery对象，因此可以链式操作。也就是说，后一个方法可以紧跟着写在前一个方法后面。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).click(function (){
    $(this).addClass(&lsquo;clicked&rsquo;);
})
.find(&lsquo;span&rsquo;)
.attr( &lsquo;title&rsquo;, &lsquo;Hover over me&rsquo; );</p>

<p>{% endhighlight %}</p>

<h3 id="document-ready:99a497817131bf421a863230ef787bd1">$(document).ready()</h3>

<p>$(document).ready方法接受一个函数作为参数，将该参数作为document对象的DOMContentLoaded事件的回调函数。也就是说，当页面解析完成（即下载完&lt;/html&gt;标签）以后，在所有外部资源（图片、脚本等）完成加载之前，该函数就会立刻运行。</p>

<p>{% highlight javascript %}</p>

<p>$( document ).ready(function() {
  console.log( &lsquo;ready!&rsquo; );
});</p>

<p>{% endhighlight %}</p>

<p>上面代码表示，一旦页面完成解析，就会运行ready方法指定的函数，在控制台显示“ready!”。</p>

<p>该方法通常作为网页初始化手段使用，jQuery提供了一种简写法，就是直接把回调函数放在jQuery对象中。</p>

<p>{% highlight javascript %}</p>

<p>$(function() {
  console.log( &lsquo;ready!&rsquo; );
});</p>

<p>{% endhighlight %}</p>

<p>上面代码与前一段代码是等价的。</p>

<h3 id="noconflict方法:99a497817131bf421a863230ef787bd1">$.noConflict方法</h3>

<p>jQuery使用美元符号（$）指代jQuery对象。某些情况下，其他函数库也会用到美元符号，为了避免冲突，$.noConflict方法允许将美元符号与jQuery脱钩。</p>

<p>{% highlight html %}</p>

<script src="other_lib.js"></script>
<script src="jquery.js"></script>
<script>$.noConflict();</script>

<p>{% endhighlight %}</p>

<p>上面代码就是$.noConflict方法的一般用法。在加载jQuery之后，立即调用该方法，会使得美元符号还给前面一个函数库。这意味着，其后再调用jQuery，只能写成jQuery.methond的形式，而不能用$.method了。</p>

<p>为了避免冲突，可以考虑从一开始就只使用jQuery代替美元符号。</p>

<h2 id="jquery实例对象的方法:99a497817131bf421a863230ef787bd1">jQuery实例对象的方法</h2>

<p>除了上一节提到的is、get、eq方法，jQuery实例还有许多其他方法。</p>

<h3 id="结果集的过滤方法:99a497817131bf421a863230ef787bd1">结果集的过滤方法</h3>

<p>选择器选出一组符合条件的网页元素以后，jQuery提供了许多方法，可以过滤结果集，返回更准确的目标。</p>

<p><strong>（1）first方法，last方法</strong></p>

<p>first方法返回结果集的第一个成员，last方法返回结果集的最后一个成员。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;li&rdquo;).first()</p>

<p>$(&ldquo;li&rdquo;).last()</p>

<p>{% endhighlight %}</p>

<p><strong>（2）next方法，prev方法</strong></p>

<p>next方法返回紧邻的下一个同级元素，prev方法返回紧邻的上一个同级元素。</p>

<pre><code class="language-javascript">$(&quot;li&quot;).first().next()
$(&quot;li&quot;).last().prev()

$(&quot;li&quot;).first().next('.item')
$(&quot;li&quot;).last().prev('.item')
</code></pre>

<p>如果<code>next</code>方法和<code>prev</code>方法带有参数，表示选择符合该参数的同级元素。</p>

<p><strong>（3）parent方法，parents方法，children方法</strong></p>

<p>parent方法返回当前元素的父元素，parents方法返回当前元素的所有上级元素（直到html元素）。</p>

<pre><code class="language-javascript">$(&quot;p&quot;).parent()
$(&quot;p&quot;).parent(&quot;.selected&quot;)

$(&quot;p&quot;).parents()
$(&quot;p&quot;).parents(&quot;div&quot;)
</code></pre>

<p>children方法返回选中元素的所有子元素。</p>

<pre><code class="language-javascript">$(&quot;div&quot;).children()
$(&quot;div&quot;).children(&quot;.selected&quot;)

// 下面的写法结果相同，但是效率较低

$('div &gt; *')
$('div &gt; .selected')
</code></pre>

<p>上面这三个方法都接受一个选择器作为参数。</p>

<p><strong>（4）siblings方法，nextAll方法，prevAll方法</strong></p>

<p>siblings方法返回当前元素的所有同级元素。</p>

<pre><code class="language-javascript">$('li').first().siblings()
$('li').first().siblings('.item')
</code></pre>

<p>nextAll方法返回当前元素其后的所有同级元素，prevAll方法返回当前元素前面的所有同级元素。</p>

<pre><code class="language-javascript">$('li').first().nextAll()
$('li').last().prevAll()
</code></pre>

<p><strong>（5）closest方法，find方法</strong></p>

<p>closest方法返回当前元素，以及当前元素的所有上级元素之中，第一个符合条件的元素。find方法返回当前元素的所有符合条件的下级元素。</p>

<pre><code class="language-javascript">$('li').closest('div')
$('div').find('li')
</code></pre>

<p>上面代码中的find方法，选中所有div元素下面的li元素，等同于$(&lsquo;li&rsquo;, &lsquo;div&rsquo;)。由于这样写缩小了搜索范围，所以要优于$(&lsquo;div li&rsquo;)的写法。</p>

<p><strong>（6）find方法，add方法，addBack方法，end方法</strong></p>

<p>add方法用于为结果集添加元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).add(&lsquo;p&rsquo;)</p>

<p>{% endhighlight %}</p>

<p>addBack方法将当前元素加回原始的结果集。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).parent().addBack()</p>

<p>{% endhighlight %}</p>

<p>end方法用于返回原始的结果集。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).first().end()</p>

<p>{% endhighlight %}</p>

<p><strong>（7）filter方法，not方法，has方法</strong></p>

<p>filter方法用于过滤结果集，它可以接受多种类型的参数，只返回与参数一致的结果。</p>

<pre><code class="language-javascript">// 返回符合CSS选择器的结果
$('li').filter('.item')

// 返回函数返回值为true的结果
$(&quot;li&quot;).filter(function(index) {
    return index % 2 === 1;
})

// 返回符合特定DOM对象的结果
$(&quot;li&quot;).filter(document.getElementById(&quot;unique&quot;))

// 返回符合特定jQuery实例的结果
$(&quot;li&quot;).filter($(&quot;#unique&quot;))
</code></pre>

<p><code>not</code>方法的用法与<code>filter</code>方法完全一致，但是返回相反的结果，即过滤掉匹配项。</p>

<pre><code class="language-javascript">$('li').not('.item')
</code></pre>

<p>has方法与filter方法作用相同，但是只过滤出子元素符合条件的元素。</p>

<pre><code class="language-javascript">$(&quot;li&quot;).has(&quot;ul&quot;)
</code></pre>

<p>上面代码返回具有ul子元素的li元素。</p>

<h3 id="dom相关方法:99a497817131bf421a863230ef787bd1">DOM相关方法</h3>

<p>许多方法可以对DOM元素进行处理。</p>

<p><strong>（1）html方法和text方法</strong></p>

<p>html方法返回该元素包含的HTML代码，text方法返回该元素包含的文本。</p>

<p>假定网页只含有一个p元素。</p>

<p>{% highlight html %}</p>

<p><em>Hello World!</em></p>

<p>{% endhighlight %}</p>

<p>html方法和text方法的返回结果分别如下。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;p&rsquo;).html()
// <em>Hello World!</em></p>

<p>$(&lsquo;p&rsquo;).text()
// Hello World!</p>

<p>{% endhighlight %}</p>

<p>jQuery的许多方法都是取值器（getter）与赋值器（setter）的合一，即取值和赋值都是同一个方法，不使用参数的时候为取值器，使用参数的时候为赋值器。</p>

<p>上面代码的html方法和text方法都没有参数，就会当作取值器使用，取回结果集的第一个元素所包含的内容。如果对这两个方法提供参数，就是当作赋值器使用，修改结果集所有成员的内容，并返回原来的结果集，以便进行链式操作。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;p&rsquo;).html(&rsquo;<strong>你好</strong>&rsquo;)
// 网页代码变为<p><strong>你好</strong></p></p>

<p>$(&lsquo;p&rsquo;).text(&lsquo;你好&rsquo;)
// 网页代码变为<p>你好</p></p>

<p>{% endhighlight %}</p>

<p>下面要讲到的jQuery其他许多方法，都采用这种同一个方法既是取值器又是赋值器的模式。</p>

<p>html方法和text方法还可以接受一个函数作为参数，函数的返回值就是网页元素所要包含的新的代码和文本。这个函数接受两个参数，第一个是网页元素在集合中的位置，第二个参数是网页元素原来的代码或文本。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).html(function (i, v){
    return (i + &lsquo;: &lsquo; + v);<br />
})</p>

<p>// <li>Hello</li>
// <li>World</li>
// 变为
// <li>0: Hello</li>
// <li>1: World</li></p>

<p>{% endhighlight %}</p>

<p><strong>（2）addClass方法，removeClass方法，toggleClass方法</strong></p>

<p>addClass方法用于添加一个类，removeClass方法用于移除一个类，toggleClass方法用于折叠一个类（如果无就添加，如果有就移除）。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).addClass(&lsquo;special&rsquo;)
$(&lsquo;li&rsquo;).removeClass(&lsquo;special&rsquo;)
$(&lsquo;li&rsquo;).toggleClass(&lsquo;special&rsquo;)</p>

<p>{% endhighlight %}</p>

<p><strong>（3）css方法</strong></p>

<p>css方法用于改变CSS设置。</p>

<p>该方法可以作为取值器使用。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;h1&rsquo;).css(&lsquo;fontSize&rsquo;);</p>

<p>{% endhighlight %}</p>

<p>css方法的参数是css属性名。这里需要注意，CSS属性名的CSS写法和DOM写法，两者都可以接受，比如font-size和fontSize都行。</p>

<p>css方法也可以作为赋值器使用。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).css(&lsquo;padding-left&rsquo;, &lsquo;20px&rsquo;)
// 或者
$(&lsquo;li&rsquo;).css({
  &lsquo;padding-left&rsquo;: &lsquo;20px&rsquo;
});</p>

<p>{% endhighlight %}</p>

<p>上面两种形式都可以用于赋值，jQuery赋值器基本上都是如此。</p>

<p><strong>（4）val方法</strong></p>

<p>val方法返回结果集第一个元素的值，或者设置当前结果集所有元素的值。</p>

<pre><code class="language-javascript">$('input[type=&quot;text&quot;]').val()
$('input[type=&quot;text&quot;]').val('new value')
</code></pre>

<p><strong>（5）prop方法，attr方法</strong></p>

<p>首先，这里要区分两种属性。</p>

<p>一种是网页元素的属性，比如<code>a</code>元素的<code>href</code>属性、<code>img</code>元素的<code>src</code>属性。这要使用<code>attr</code>方法读写。</p>

<pre><code class="language-javascript">// 读取属性值
$('textarea').attr(name)

//写入属性值
$('textarea').attr(name, val)
</code></pre>

<p>下面是通过设置<code>a</code>元素的<code>target</code>属性，使得网页上的外部链接在新窗口打开的例子。</p>

<pre><code class="language-javascript">$('a[href^=&quot;http&quot;]').attr('target', '_blank');
$('a[href^=&quot;//&quot;]').attr('target', '_blank');
$('a[href^=&quot;' + window.location.origin + '&quot;]').attr('target', '_self');
</code></pre>

<p>另一种是DOM元素的属性，比如<code>tagName</code>、<code>nodeName</code>、<code>nodeType</code>等等。这要使用<code>prop</code>方法读写。</p>

<pre><code class="language-javascript">// 读取属性值
$('textarea').prop(name)

// 写入属性值
$('textarea').prop(name, val)
</code></pre>

<p>所以，<code>attr</code>方法和<code>prop</code>方法针对的是不同的属性。在英语中，<code>attr</code>是attribute的缩写，<code>prop</code>是property的缩写，中文很难表达出这种差异。有时，<code>attr</code>方法和<code>prop</code>方法对同一个属性会读到不一样的值。比如，网页上有一个单选框。</p>

<p>{% highlight html %}</p>

<p><input type="checkbox" checked="checked" /></p>

<p>{% endhighlight %}</p>

<p>对于checked属性，attr方法读到的是checked，prop方法读到的是true。</p>

<p>{% highlight javascript %}</p>

<p>$(input[type=checkbox]).attr(&ldquo;checked&rdquo;) // &ldquo;checked&rdquo;</p>

<p>$(input[type=checkbox]).prop(&ldquo;checked&rdquo;) // true</p>

<p>{% endhighlight %}</p>

<p>可以看到，attr方法读取的是网页上该属性的值，而prop方法读取的是DOM元素的该属性的值，根据规范，element.checked应该返回一个布尔值。所以，判断单选框是否选中，要使用prop方法。事实上，不管这个单选框是否选中，attr(&ldquo;checked&rdquo;)的返回值都是checked。</p>

<p>{% highlight javascript %}</p>

<p>if ($(elem).prop(&ldquo;checked&rdquo;)) { /*&hellip; */ };</p>

<p>// 下面两种方法亦可</p>

<p>if ( elem.checked ) { /<em>&hellip;</em>/ };
if ( $(elem).is(&rdquo;:checked&rdquo;) ) { /<em>&hellip;</em>/ };</p>

<p>{% endhighlight %}</p>

<p><strong>（6）removeProp方法，removeAttr方法</strong></p>

<p>removeProp方法移除某个DOM属性，removeAttr方法移除某个HTML属性。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;a&rdquo;).prop(&ldquo;oldValue&rdquo;,1234).removeProp(&lsquo;oldValue&rsquo;)
$(&lsquo;a&rsquo;).removeAttr(&ldquo;title&rdquo;)</p>

<p>{% endhighlight %}</p>

<p><strong>（7）data方法</strong></p>

<p>data方法用于在一个DOM对象上储存数据。</p>

<p>{% highlight javascript %}</p>

<p>// 储存数据
$(&ldquo;body&rdquo;).data(&ldquo;foo&rdquo;, 52);</p>

<p>// 读取数据
$(&ldquo;body&rdquo;).data(&ldquo;foo&rdquo;);</p>

<p>{% endhighlight %}</p>

<p>该方法可以在DOM节点上储存各种类型的数据。</p>

<h3 id="添加-复制和移动网页元素的方法:99a497817131bf421a863230ef787bd1">添加、复制和移动网页元素的方法</h3>

<p>jQuery方法提供一系列方法，可以改变元素在文档中的位置。</p>

<p><strong>（1）append方法，appendTo方法</strong></p>

<p>append方法将参数中的元素插入当前元素的尾部。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;div&rdquo;).append(&rdquo;<p>World</p>&rdquo;)</p>

<p>// <div>Hello </div>
// 变为
// <div>Hello <p>World</p></div></p>

<p>{% endhighlight %}</p>

<p>appendTo方法将当前元素插入参数中的元素尾部。</p>

<p>{% highlight javascript %}</p>

<p>$(&rdquo;<p>World</p>&rdquo;).appendTo(&ldquo;div&rdquo;)</p>

<p>{% endhighlight %}</p>

<p>上面代码返回与前一个例子一样的结果。</p>

<p><strong>（2）prepend方法，prependTo方法</strong></p>

<p>prepend方法将参数中的元素，变为当前元素的第一个子元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;p&rdquo;).prepend(&ldquo;Hello &ldquo;)</p>

<p>// <p>World</p>
// 变为
// <p>Hello World</p></p>

<p>{% endhighlight %}</p>

<p>如果prepend方法的参数不是新生成的元素，而是当前页面已存在的元素，则会产生移动元素的效果。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;p&rdquo;).prepend(&ldquo;strong&rdquo;)</p>

<p>// <strong>Hello </strong><p>World</p>
// 变为
// <p><strong>Hello </strong>World</p></p>

<p>{% endhighlight %}</p>

<p>上面代码运行后，strong元素的位置将发生移动，而不是克隆一个新的strong元素。不过，如果当前结果集包含多个元素，则除了第一个以后，后面的p元素都将插入一个克隆的strong子元素。</p>

<p>prependTo方法将当前元素变为参数中的元素的第一个子元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&rdquo;<p></p>&rdquo;).prependTo(&ldquo;div&rdquo;)</p>

<p>// <div></div>
// 变为
// <div><p></p></div></p>

<p>{% endhighlight %}</p>

<p><strong>（3）after方法，insertAfter方法</strong></p>

<p>after方法将参数中的元素插在当前元素后面。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;div&rdquo;).after(&rdquo;<p></p>&rdquo;)</p>

<p>// <div></div>
// 变为
// <div></div><p></p></p>

<p>{% endhighlight %}</p>

<p>insertAfter方法将当前元素插在参数中的元素后面。</p>

<p>{% highlight javascript %}</p>

<p>$(&rdquo;<p></p>&rdquo;).insertAfter(&ldquo;div&rdquo;)</p>

<p>{% endhighlight %}</p>

<p>上面代码返回与前一个例子一样的结果。</p>

<p><strong>（4）before方法，insertBefore方法</strong></p>

<p>before方法将参数中的元素插在当前元素的前面。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;div&rdquo;).before(&rdquo;<p></p>&rdquo;)</p>

<p>// <div></div>
// 变为
// <p></p><div></div></p>

<p>{% endhighlight %}</p>

<p>insertBefore方法将当前元素插在参数中的元素的前面。</p>

<p>{% highlight javascript %}</p>

<p>$(&rdquo;<p></p>&rdquo;).insertBefore(&ldquo;div&rdquo;)</p>

<p>{% endhighlight %}</p>

<p>上面代码返回与前一个例子一样的结果。</p>

<p><strong>（5）wrap方法，wrapAll方法，unwrap方法，wrapInner方法</strong></p>

<p>wrap方法将参数中的元素变成当前元素的父元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;p&rdquo;).wrap(&rdquo;<div></div>&rdquo;)</p>

<p>// <p></p>
// 变为
// <div><p></p></div></p>

<p>{% endhighlight %}</p>

<p>wrap方法的参数还可以是一个函数。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;p&rdquo;).wrap(function() {
  return &ldquo;<div></div>&rdquo;;
})</p>

<p>{% endhighlight %}</p>

<p>上面代码返回与前一个例子一样的结果。</p>

<p>wrapAll方法为结果集的所有元素，添加一个共同的父元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;p&rdquo;).wrapAll(&rdquo;<div></div>&rdquo;)</p>

<p>// <p></p><p></p>
// 变为
// <div><p></p><p></p></div></p>

<p>{% endhighlight %}</p>

<p>unwrap方法移除当前元素的父元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;p&rdquo;).unwrap()</p>

<p>// <div><p></p></div>
// 变为
// <p></p></p>

<p>{% endhighlight %}</p>

<p>wrapInner方法为当前元素的所有子元素，添加一个父元素。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;p&rdquo;).wrapInner(&rsquo;<strong></strong>&rsquo;)</p>

<p>// <p>Hello</p>
// 变为
// <p><strong>Hello</strong></p></p>

<p>{% endhighlight %}</p>

<p><strong>（6）clone方法</strong></p>

<p>clone方法克隆当前元素。</p>

<p>{% highlight javascript %}</p>

<p>var clones = $(&lsquo;li&rsquo;).clone();</p>

<p>{% endhighlight %}</p>

<p>对于那些有id属性的节点，clone方法会连id属性一起克隆。所以，要把克隆的节点插入文档的时候，务必要修改或移除id属性。</p>

<p><strong>（7）remove方法，detach方法，replaceWith方法</strong></p>

<p>remove方法移除并返回一个元素，取消该元素上所有事件的绑定。detach方法也是移除并返回一个元素，但是不取消该元素上所有事件的绑定。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;p&rsquo;).remove()
$(&lsquo;p&rsquo;).detach()</p>

<p>{% endhighlight %}</p>

<p>replaceWith方法用参数中的元素，替换并返回当前元素，取消当前元素的所有事件的绑定。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;p&rsquo;).replaceWith(&rsquo;<div></div>&rsquo;)</p>

<p>{% endhighlight %}</p>

<h3 id="动画效果方法:99a497817131bf421a863230ef787bd1">动画效果方法</h3>

<p>jQuery提供一些方法，可以很容易地显示网页动画效果。但是，总体上来说，它们不如CSS动画强大和节省资源，所以应该优先考虑使用CSS动画。</p>

<p>如果将jQuery.fx.off设为true，就可以将所有动画效果关闭，使得网页元素的各种变化一步到位，没有中间过渡的动画效果。</p>

<p><strong>（1）动画效果的简便方法</strong></p>

<p>jQuery提供以下一些动画效果方法。</p>

<ul>
<li>show：显示当前元素。</li>
<li>hide：隐藏当前元素。</li>
<li>toggle：显示或隐藏当前元素。</li>
<li>fadeIn：将当前元素的不透明度（opacity）逐步提升到100%。</li>
<li>fadeOut：将当前元素的不透明度逐步降为0%。</li>
<li>fadeToggle：以逐渐透明或逐渐不透明的方式，折叠显示当前元素。</li>
<li>slideDown：以从上向下滑入的方式显示当前元素。</li>
<li>slideUp：以从下向上滑出的方式隐藏当前元素。</li>
<li>slideToggle：以垂直滑入或滑出的方式，折叠显示当前元素。</li>
</ul>

<p>上面这些方法可以不带参数调用，也可以接受毫秒或预定义的关键字作为参数。</p>

<pre><code class="language-javascript">$('.hidden').show();
$('.hidden').show(300);
$('.hidden').show('slow');
</code></pre>

<p>上面三行代码分别表示，以默认速度、300毫秒、较慢的速度隐藏一个元素。</p>

<p>jQuery预定义的关键字是在<code>jQuery.fx.speeds</code>对象上面，可以自行改动这些值，或者创造新的值。</p>

<pre><code class="language-javascript">jQuery.fx.speeds.fast = 50;
jQuery.fx.speeds.slow = 3000;
jQuery.fx.speeds.normal = 1000;
</code></pre>

<p>上面三行代码重新定义fast、normal、slow关键字对应的毫秒数。</p>

<p>你还可以定义自己的关键字。</p>

<pre><code class="language-javascript">jQuery.fx.speeds.blazing = 30;

// 调用
$('.hidden').show('blazing');
</code></pre>

<p>这些方法还可以接受一个函数，作为第二个参数，表示动画结束后的回调函数。</p>

<pre><code class="language-javascript">$('p').fadeOut(300, function() {
  $(this).remove();
});
</code></pre>

<p>上面代码表示，<code>p</code>元素以300毫秒的速度淡出，然后调用回调函数，将其从DOM中移除。</p>

<p>使用按钮控制某个元素折叠显示的代码如下。</p>

<pre><code class="language-javascript">// Fade
$('.btn').click(function () {
  $('.element').fadeToggle('slow');
});

// Toggle
$('.btn').click(function () {
  $('.element').slideToggle('slow');
});
</code></pre>

<p><strong>（2）animate方法</strong></p>

<p>上面这些动画效果方法，实际上都是animate方法的简便写法。在幕后，jQuery都是统一使用animate方法生成各种动画效果。</p>

<pre><code class="language-javascript">$('a.top').click(function (e) {
  e.preventDefault();
  $('html, body').animate({scrollTop: 0}, 800);
});
</code></pre>

<p>上面代码是点击链接，回到页面头部的写法。其中，<code>animate</code>方法接受两个参数，第一个参数是一个对象，表示动画结束时相关CSS属性的值，第二个参数是动画持续的毫秒数。需要注意的是，第一个参数对象的成员名称，必须与CSS属性名称一致，如果CSS属性名称带有连字号，则需要用“骆驼拼写法”改写。</p>

<p>animate方法还可以接受第三个参数，表示动画结束时的回调函数。</p>

<pre><code class="language-javascript">$('div').animate({
    left: '+=50', // 增加50
    opacity: 0.25,
    fontSize: '12px'
  },
  300, // 持续时间
  function() { // 回调函数
     console.log('done!');
  }
);
</code></pre>

<p>上面代码表示，动画结束时，在控制台输出“done！”。</p>

<p><strong>（3）stop方法，delay方法</strong></p>

<p>stop方法表示立即停止执行当前的动画。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;#stop&rdquo;).click(function() {
  $(&ldquo;.block&rdquo;).stop();
});</p>

<p>{% endhighlight %}</p>

<p>上面代码表示，点击按钮后，block元素的动画效果停止。</p>

<p>delay方法接受一个时间参数，表示暂停多少毫秒后继续执行。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;#foo&rdquo;).slideUp(300).delay(800).fadeIn(400)</p>

<p>{% endhighlight %}</p>

<p>上面代码表示，slideUp动画之后，暂停800毫秒，然后继续执行fadeIn动画。</p>

<h3 id="其他方法:99a497817131bf421a863230ef787bd1">其他方法</h3>

<p>jQuery还提供一些供特定元素使用的方法。</p>

<p>serialize方法用于将表单元素的值，转为url使用的查询字符串。</p>

<p>{% highlight javascript %}</p>

<p>$( &ldquo;form&rdquo; ).on( &ldquo;submit&rdquo;, function( event ) {
  event.preventDefault();
  console.log( $( this ).serialize() );
});
// single=Single&amp;multiple=Multiple&amp;check=check2&amp;radio=radio1</p>

<p>{% endhighlight %}</p>

<p>serializeArray方法用于将表单元素的值转为数组。</p>

<pre><code class="language-javascript">$(&quot;form&quot;).submit(function (event){
  console.log($(this).serializeArray());
  event.preventDefault();
});
//  [
//      {name : 'field1', value : 123},
//      {name : 'field2', value : 'hello world'}
//  ]
</code></pre>

<h2 id="事件处理:99a497817131bf421a863230ef787bd1">事件处理</h2>

<h3 id="事件绑定的简便方法:99a497817131bf421a863230ef787bd1">事件绑定的简便方法</h3>

<p>jQuery提供一系列方法，允许直接为常见事件绑定回调函数。比如，click方法可以为一个元素绑定click事件的回调函数。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).click(function (e){
  console.log($(this).text());
});</p>

<p>{% endhighlight %}</p>

<p>上面代码为li元素绑定click事件的回调函数，点击后在控制台显示li元素包含的文本。</p>

<p>这样绑定事件的简便方法有如下一些：</p>

<ul>
<li>click</li>
<li>keydown</li>
<li>keypress</li>
<li>keyup</li>
<li>mouseover</li>
<li>mouseout</li>
<li>mouseenter</li>
<li>mouseleave</li>
<li>scroll</li>
<li>focus</li>
<li>blur</li>
<li>resize</li>
<li>hover</li>
</ul>

<p>如果不带参数调用这些方法，就是触发相应的事件，从而引发回调函数的运行。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).click()</p>

<p>{% endhighlight %}</p>

<p>上面代码将触发click事件的回调函数。</p>

<p>需要注意的是，通过这种方法触发回调函数，将不会引发浏览器对该事件的默认行为。比如，对a元素调用click方法，将只触发事先绑定的回调函数，而不会导致浏览器将页面导向href属性指定的网址。</p>

<p>下面是一个捕捉用户按下escape键的函数。</p>

<pre><code class="language-javascript">
$(document).keyup(function(e) {
  if (e.keyCode == 27) {
    $('body').toggleClass('show-nav');
    // $('body').removeClass('show-nav');
  }
});

</code></pre>

<p>上面代码中，用户按下escape键，jQuery就会为body元素添加/去除名为show-nav的class。</p>

<p><code>hover</code>方法需要特别说明。它接受两个回调函数作为参数，分别代表<code>mouseenter</code>和<code>mouseleave</code>事件的回调函数。</p>

<pre><code class="language-javascript">$(selector).hover(handlerIn, handlerOut)
// 等同于
$(selector).mouseenter(handlerIn).mouseleave(handlerOut)
</code></pre>

<p>下面是一个例子，当按钮发生<code>hover</code>事件，添加一个class样式，当<code>hover</code>事件结束时，再取消这个class。</p>

<pre><code class="language-javascript">$('.btn').hover(function () {
  $(this).addClass('hover');
}, function () {
  $(this).removeClass('hover');
});
</code></pre>

<p>使用<code>toggleClass</code>可以简化上面的代码。</p>

<pre><code class="language-javascript">$('.btn').hover(function () {
  $(this).toggleClass('hover');
});
</code></pre>

<h3 id="on方法-trigger方法-off方法:99a497817131bf421a863230ef787bd1">on方法，trigger方法，off方法</h3>

<p>除了简便方法，jQuery还提供事件处理的通用方法。</p>

<p><strong>（1）on方法</strong></p>

<p><code>on</code>方法是jQuery事件绑定的统一接口。事件绑定的那些简便方法，其实都是<code>on</code>方法的简写形式。</p>

<p><code>on</code>方法接受两个参数，第一个是事件名称，第二个是回调函数。</p>

<pre><code class="language-javascript">$('li').on('click', function (e){
  console.log($(this).text());
});
</code></pre>

<p>上面代码为<code>li</code>元素绑定<code>click</code>事件的回调函数。</p>

<blockquote>
<p>注意，在回调函数内部，<code>this</code>关键字指的是发生该事件的DOM对象。为了使用jQuery提供的方法，必须将DOM对象转为jQuery对象，因此写成<code>$(this)</code>。</p>
</blockquote>

<p><code>on</code>方法允许一次为多个事件指定同样的回调函数。</p>

<pre><code class="language-javascript">$('input[type=&quot;text&quot;]').on('focus blur', function (){
  console.log('focus or blur');
});
</code></pre>

<p>上面代码为文本框的<code>focus</code>和<code>blur</code>事件绑定同一个回调函数。</p>

<p>下面是一个例子，当图片加载失败，使用<code>error</code>事件，替换另一张图片。</p>

<pre><code class="language-javascript">$('img').on('error', function () {
  if(!$(this).hasClass('broken-image')) {
    $(this).prop('src', 'img/broken.png').addClass('broken-image');
  }
});
</code></pre>

<p>下面是检查用户是否切换浏览器tab的例子。</p>

<pre><code class="language-javascript">$(document).on('visibilitychange', function (e) {
  if (e.target.visibilityState === &quot;visible&quot;) {
    console.log('Tab is now in view!');
  } else if (e.target.visibilityState === &quot;hidden&quot;) {
    console.log('Tab is now hidden!');
  }
});
</code></pre>

<p><code>on</code>方法还可以为当前元素的某一个子元素，添加回调函数。</p>

<pre><code class="language-javascript">$('ul').on('click', 'li', function (e){
  console.log(this);
});
</code></pre>

<p>上面代码为<code>ul</code>的子元素<code>li</code>绑定click事件的回调函数。采用这种写法时，on方法接受三个参数，子元素选择器作为第二个参数，夹在事件名称和回调函数之间。</p>

<p>这种写法有两个好处。首先，click事件还是在ul元素上触发回调函数，但是会检查event对象的target属性是否为li子元素，如果为true，再调用回调函数。这样就比为li元素一一绑定回调函数，节省了内存空间。其次，这种绑定的回调函数，对于在绑定后生成的li元素依然有效。</p>

<p>on方法还允许向回调函数传入数据。</p>

<pre><code class="language-javascript">$(&quot;ul&quot; ).on(&quot;click&quot;, {name: &quot;张三&quot;}, function (event){
    console.log(event.data.name);
});
</code></pre>

<p>上面代码在发生click事件之后，会通过event对象的data属性，在控制台打印出所传入的数据（即“张三”）。</p>

<p><strong>（2）trigger方法</strong></p>

<p>trigger方法用于触发回调函数，它的参数就是事件的名称。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).trigger(&lsquo;click&rsquo;)</p>

<p>{% endhighlight %}</p>

<p>上面代码触发li元素的click事件回调函数。与那些简便方法一样，trigger方法只触发回调函数，而不会引发浏览器的默认行为。</p>

<p><strong>（3）off方法</strong></p>

<p>off方法用于移除事件的回调函数。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).off(&lsquo;click&rsquo;)</p>

<p>{% endhighlight %}</p>

<p>上面代码移除li元素所有的click事件回调函数。</p>

<p><strong>（4）事件的名称空间</strong></p>

<p>同一个事件有时绑定了多个回调函数，这时如果想移除其中的一个回调函数，可以采用“名称空间”的方式，即为每一个回调函数指定一个二级事件名，然后再用off方法移除这个二级事件的回调函数。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).on(&lsquo;click.logging&rsquo;, function (){
  console.log(&lsquo;click.logging callback removed&rsquo;);
});</p>

<p>$(&lsquo;li&rsquo;).off(&lsquo;click.logging&rsquo;);</p>

<p>{% endhighlight %}</p>

<p>上面代码为li元素定义了二级事件click.logging的回调函数，click.logging属于click名称空间，当发生click事件时会触发该回调函数。将click.logging作为off方法的参数，就会移除这个回调函数，但是对其他click事件的回调函数没有影响。</p>

<p>trigger方法也适用带名称空间的事件。</p>

<p>{% highlight javascript %}</p>

<p>$(&lsquo;li&rsquo;).trigger(&lsquo;click.logging&rsquo;)</p>

<p>{% endhighlight %}</p>

<h3 id="event对象:99a497817131bf421a863230ef787bd1">event对象</h3>

<p>当回调函数被触发后，它们的参数通常是一个事件对象event。</p>

<p>{% highlight javascript %}</p>

<p>$(document).on(&lsquo;click&rsquo;, function (e){
    // &hellip;
});</p>

<p>{% endhighlight %}</p>

<p>上面代码的回调函数的参数e，就代表事件对象event。</p>

<p>event对象有以下属性：</p>

<ul>
<li>type：事件类型，比如click。</li>
<li>which：触发该事件的鼠标按钮或键盘的键。</li>
<li>target：事件发生的初始对象。</li>
<li>data：传入事件对象的数据。</li>
<li>pageX：事件发生时，鼠标位置的水平坐标（相对于页面左上角）。</li>
<li>pageY：事件发生时，鼠标位置的垂直坐标（相对于页面左上角）。</li>
</ul>

<p>event对象有以下方法：</p>

<ul>
<li>preventDefault：取消浏览器默认行为。</li>
<li>stopPropagation：阻止事件向上层元素传播。</li>
</ul>

<h3 id="一次性事件:99a497817131bf421a863230ef787bd1">一次性事件</h3>

<p>one方法指定一次性的回调函数，即这个函数只能运行一次。这对提交表单很有用。</p>

<p>{% highlight javascript %}</p>

<p>$(&ldquo;#button&rdquo;).one( &ldquo;click&rdquo;, function() { return false; } );</p>

<p>{% endhighlight %}</p>

<p>one方法本质上是回调函数运行一次，即解除对事件的监听。</p>

<p>{% highlight javascript %}</p>

<p>document.getElementById(&ldquo;#button&rdquo;).addEventListener(&ldquo;click&rdquo;, handler);</p>

<p>function handler(e) {
    e.target.removeEventListener(e.type, arguments.callee);
    return false;
}</p>

<p>{% endhighlight %}</p>

<p>上面的代码在点击一次以后，取消了对click事件的监听。如果有特殊需要，可以设定点击2次或3次之后取消监听，这都是可以的。</p>

<h2 id="参考链接:99a497817131bf421a863230ef787bd1">参考链接</h2>

<ul>
<li>Elijah Manor, <a href="http://www.elijahmanor.com/2013/01/yo-dawg-i-herd-you-like-loops-so-jquery.html">Do You Know When You Are Looping in jQuery?</a></li>
<li>Craig Buckler, <a href="http://www.sitepoint.com/create-one-time-events-javascript/">How to Create One-Time Events in JavaScript</a></li>
<li>jQuery Fundamentals, <a href="http://jqfundamentals.com/chapter/jquery-basics">jQuery Basics</a></li>
<li>jQuery Fundamentals, <a href="http://jqfundamentals.com/chapter/effects">Animating Your Pages with jQuery</a></li>
</ul>

	</div>
  <footer class="article-footer clearfix">
  

<div class="article-tags">
  <span></span>
  
  <a href="/tags/development">Development</a>
  
  <a href="/tags/javascript">JavaScript</a>
  
</div>



<div class="article-categories">
  <span></span>
  
  <a class="article-category-link" href="/categories/development">Development</a>
  
  <a class="article-category-link" href="/categories/javascript">JavaScript</a>
  
</div>



  <div class="article-share" id="share">
    <div data-url="http://575087694.github.io/post/index11/" data-title="10、jQuery" data-tsina="1816308191" class="share clearfix">
    </div>
  </div>
</footer>

	</article>
  


<section class="comment">
<div id="disqus_thread"></div>
</section>
<script>


var disqus_config = function () {
this.page.url = "http://575087694.github.io/post/index11/";
this.page.identifier = "http://575087694.github.io/post/index11/";
};
(function() { 
var d = document, s = d.createElement('script');

s.src = '//SmallLiu.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

    <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">
  

<div class="categorieslist">
  <p class="asidetitle">分类</p>
  <ul>
    
    <li><a href="http://575087694.github.io/categories/development" title="development">development<sup>11</sup></a></li>
    
    <li><a href="http://575087694.github.io/categories/javascript" title="javascript">javascript<sup>11</sup></a></li>
    
  </ul>
</div>



  

<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
      
			<li><a href="http://575087694.github.io/tags/development" title="development">development<sup>11</sup></a></li>
      
			<li><a href="http://575087694.github.io/tags/javascript" title="javascript">javascript<sup>11</sup></a></li>
      
		</ul>
</div>



  
  <div class="archiveslist">
    <p class="asidetitle">归档</p>
    <ul class="archive-list">
      
      
      <li class="archive-list-item">
        <a class="archive-list-link" href="http://575087694.github.io/post/#2014-01">2014年01月</a><span class="archive-list-count">11</span>
      </li>
      
    </ul>

  </div>


  

<div class="tagcloudlist">
  <p class="asidetitle">标签云</p>
  <div class="tagcloudlist clearfix">
    
    <a href="http://575087694.github.io/tags/development" style="font-size: 12px;">development</a>
    
    <a href="http://575087694.github.io/tags/javascript" style="font-size: 12px;">javascript</a>
    
  </div>
</div>



  

</aside>
</div>

  </div>
  <footer><div id="footer" >
  
  <div class="line">
    <span></span>
    <div style='background:no-repeat url("http://575087694.github.io/img/author.jpg") left top;-webkit-background-size:6.875em 6.875em;-moz-background-size:6.875em 6.875em;background-size:6.875em 6.875em;' class="author" ></div>
  </div>
  
  
  <section class="info">
    <p>Introduce1 <br/> Introduce2</p>
  </section>
  
  <div class="social-font clearfix">
    
    <a href="http://weibo.com/SmallLiu" target="_blank" title="weibo"></a>
    
    
    <a href="https://twitter.com/SmallLiu" target="_blank" title="twitter"></a>
    
    
    <a href="https://github.com/SmallLiu" target="_blank" title="github"></a>
    
    
    <a href="https://www.facebook.com/SmallLiu" target="_blank" title="facebook"></a>
    
    
    <a href="https://www.linkedin.com/SmallLiu" target="_blank" title="linkedin"></a>
    
  </div>
  <p class="copyright">Powered by <a href="http://gohugo.io" target="_blank" title="hugo">hugo</a> and Theme by <a href="https://github.com/coderzh/hugo-pacman-theme" target="_blank" title="hugo-pacman-theme">hugo-pacman-theme</a> © 2016
    
    <a href="http://575087694.github.io/" target="_blank" title="SmallLiu">SmallLiu</a>
    
  </p>
</div>
</footer>
  <script src="http://575087694.github.io/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:http:\/\/575087694.github.io\/} ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      h  = $('article h2')
      ah = $('article h2'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  if(ah.length==0){
    t.css('display','none');
  }else{
    c.click(function(){
      ta.css('display', 'block').addClass('fadeIn');
    });
    o.click(function(){
      ta.css('display', 'none');
    });
    $(window).scroll(function(){
      ta.css("top",Math.max(140,320-$(this).scrollTop()));
    });
  };
});
</script>

<script type="text/javascript">
$(document).ready(function(){
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina');
  var html = [
  '<a href="#" class="overlay" id="qrcode"></a>',
  '<div class="qrcode clearfix"><span>扫描二维码分享到微信朋友圈</span><a class="qrclose" href="#share"></a><strong>Loading...Please wait</strong><img id="qrcode-pic" data-src="http://s.jiathis.com/qrcode.php?url=' + encodedUrl + '"/></div>',
  '<a href="#textlogo" class="article-back-to-top" title="Top"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="QRcode"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="Weibo"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);
  $('.article-share-qrcode').click(function(){
    var imgSrc = $('#qrcode-pic').attr('data-src');
    $('#qrcode-pic').attr('src', imgSrc);
    $('#qrcode-pic').load(function(){
        $('.qrcode strong').text(' ');
    });
  });
});
</script>


<link rel="stylesheet" href="http://575087694.github.io/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="http://575087694.github.io/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
});
</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-10147768-2', 'auto');
  ga('send', 'pageview');
  $('#messagesbsb').remove();
</script>



</body>
</html>
